\documentclass[a4paper, 12pt]{article}
\include{includes/packages}
\include{includes/consts}
\include{includes/colors}
\include{includes/styles}
\include{includes/listings}
\begin{document}
\input{includes/titlepage}
\pagebreak
\tableofcontents
\newpage
% Основная часть --------------------------------------------------------------------------------------------
\section*{Задание}
\addcontentsline{toc}{section}{Задание}
\subsection*{Цель}
\begin{enumerate}
    \item Освоить основные этапы применения алгоритмов машинного обучения в Apache Spark MLlib или Flink ML для решения задач классификации и регрессии (прогнозирования).
    \item  Научиться работать с классическими открытыми датасетами.
    \item Закрепить изученный материал (методы обработки, обучения, тестирования, оценки метрик).
\end{enumerate}

\section{Ход работы}
Для выполнения использовался тот же docker-образ, что и для ЛР 1 и 2.

Перед запуском на Hadoop загружаютяс файлы датасетов.
\lstinputlisting[language=bash, caption={скрипт загрузки датасетов}]{../scripts/put_files.sh}

\subsection{Классификация}

От преподавателя был получен вариант 1 по классификации - Классификация видов ирисов (3 класса, 4 признака). В файл по предоставленной ссылке был добавлен хедер "X1,X2,X3,X4,Y" для работы с ним через pyspark.

Код скрипта классификации представлен ниже.

\lstinputlisting[language=python, caption={Скрипт классификации}]{../scripts/lab3_1.py}

После загрузки датасета выводятся его первые 3 строки и схема для проверки соответсвия датасета желаемому. Далее все признаки объединяются в один вектор, а строковые метки преобразуются в числовые. Затем через StandartScaler проводится масштабирование. После чего датасет делится на обучающую и тестовую выборку, инициализируется модель логистической регрессии. На последнем этапе проверяется точность предсказания.

Вывод скрипта представлен ниже.
\lstinputlisting[style=text, caption={Вывод скрипта классификации}]{../scripts/1.out}

Как видно в выводе точность получилась 1, то есть модель обучилась верно.

\subsection{Регрессия}

От преподавателя был получен вариант 1 по регрессии - Физико-химические параметры и качество португальских вин.

Код скрипта регрессии представлен ниже.

\lstinputlisting[language=python, caption={Скрипт регрессии}]{../scripts/lab3_2.py}

Для уменьшения размерности признаков был выбран PCA, который оставляет 6 наиболее информативных признаков. В качестве модели выбран случайный лес, в котором 100 деревьев глубины 10. Для оценки качества работы модели были выбраны RMSE и MAE.

Вывод скрипта регрессии представлен ниже.

\lstinputlisting[style=text, caption={Вывод скрипта регрессии}, basicstyle={\fontsize{1}{3} \selectfont smaller than tiny} ]{../scripts/2.out}

Показания довольно высоки, то есть модель часто ошибается. Получается, модель не очень подходит для этой задачи.

% -------------------------------------------------------
\newpage
\section{Вывод}
в ходе выполнения лабораторной работы был закреплен полученный материал: освоены основные этапы применения алгоритмов машинного обучения в Apache Spark MLlib для решения задач классификации и регрессии, получены навыки работы с классическими открытыми датасетами.
%-----------------------------------------------------------------------------------------
\end{document}
